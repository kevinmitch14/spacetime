!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).spacetime=t()}(this,(function(){"use strict";var e={methods:{now:()=>(new Date).getTime(),parse:e=>e},model:{},config:{},zones:{}};class t{constructor(t,r){Object.defineProperty(this,"world",{value:e});let n=e.methods.parse(t,r,e);this._epoch=n.epoch,this.tz=n.tz,Object.defineProperty(this,"isSpacetime",{value:!0})}get epoch(){if(this.isRunning&&null!==this.startEpoch){let e=this.world.now.epoch()-this.startEpoch;return this._epoch+e}return this._epoch}}t.prototype._from=function(e,r){let n=new t(e,r||this.tz);return n.started=this.started,n.world=this.world,n};var r=t;const n=(e,t)=>new r(e,t);n.world=e,n.plugin=function(e){Object.assign(n.world.zones,e.zones||{}),Object.assign(n.world.config,e.config||{}),Object.assign(n.world.model,e.model||{}),Object.assign(r.prototype,e.api||{}),Object.assign(n.world.methods,e.methods||{})},n.version="7.4.0",n.now=e=>new r(null,e),n.today=e=>n.now(e).startOf("day"),n.tomorrow=e=>n.today(e).add(1,"day"),n.yesterday=e=>n.today(e).minus(1,"day");var o=n;const s=36e5,a=24*s;var l={months:[{long:"January",short:"Jan",len:31},{long:"February",short:"Feb",len:28},{long:"March",short:"Mar",len:31},{long:"April",short:"Apr",len:30},{long:"May",short:"May",len:31},{long:"June",short:"Jun",len:30},{long:"July",short:"Jul",len:31},{long:"August",short:"Aug",len:31},{long:"September",short:"Sep",len:30},{long:"October",short:"Oct",len:31},{long:"November",short:"Nov",len:30},{long:"December",short:"Dec",len:31}],days:[{long:"sunday",short:"sun"},{long:"monday",short:"mon"},{long:"tuesday",short:"tue"},{long:"wednesday",short:"wed"},{long:"thursday",short:"thu"},{long:"friday",short:"fri"},{long:"saturday",short:"sat"}],time:{am:"am",pm:"pm"},ms:{SECOND:1e3,MINUTE:6e4,HOUR:s,DAY:a,YEAR:31536e6}};let i={"Etc/GMT":{offset:0,hem:"n"}};for(let e=-14;e<=14;e+=.5){let t=e;t>0&&(t="+"+t);let r="Etc/GMT"+t;i[r]={offset:-1*e,hem:"n"},i["UTC/GMT"+t]=i[r]}i["Etc/GMT+0"]=i["Etc/GMT"],i["Etc/GMT-0"]=i["Etc/GMT"];var u=i;var m=function(e,t,r){let n=function(e){let t=e%100;return(t+parseInt(t/4,10))%7}(e),o=[null,0,3,3,6,1,4,6,2,5,0,3,5][t];let s=function(e){if(e<1752)return(18-parseInt(e/100,10))%7;let t=parseInt(e/100,10);return{17:4,18:2,19:0,20:6,21:4,22:2,23:0}[String(t)]||0}(e),a=r,l=function(e){return!0==(e%4==0&&e%100!=0||e%400==0)?-1:0}(e);return(n+o+s+a+l)%7};const h=e=>"number"==typeof e;let c={sept:9};var d=function(e){return h(e)?e:(e=e.toLowerCase().trim(),c[e])};const f=/^([+-])?([0-9]{1,2}):?([0-9]{2})?$/;var p=e=>{if(!e)return null;if("Z"===e||"z"===e)return 0;let t=e.match(f);if(null!==t){let[,e,r,n]=t;r=parseInt(r||"",10)||0,n=parseInt(n||"",10)||0,n/=60;let o=r+n;return"-"===e&&(o*=-1),o}return null};var g=function(e){if(h(e))return e;e=(e=(e=e.trim().toLowerCase()).replace(/^[0:]+/,"")).replace(/([0-9])h$/,"$1");let t=parseInt(e,10);if(t)return t;let r=e.match(/([0-9]+) ?(am|pm)$/);if(null!==r&&r[1]){let e=Number(r[1]);return"pm"===r[2]&&(e+=12),e}return 0};const y={hour:0,minute:0,second:0,millisecond:0};var b=(e="",t)=>{t=Object.assign({},y,t);let r=(e=e.replace(/^\s+/,"").toLowerCase()).match(/([0-9]{1,2}):([0-9]{1,2}):?([0-9]{1,2})?[:.]?([0-9]{1,4})?/);if(null!==r){let n=Number(r[1]);if(n<0||n>24)return t;let o=Number(r[2]);if(r[2].length<2||o<0||o>59)return t;t.hour=n,t.minute=o,t.second=Number(r[3])||0,t.millisecond=function(e=""){return(e=String(e)).length>3?e=e.substring(0,3):1===e.length?e+="00":2===e.length&&(e+="0"),Number(e)||0}(r[4]);let s=e.match(/[\\b0-9] ?(am|pm)\b/);return null!==s&&"pm"===s[1]&&(t.hour+=12),t}let n=g(e);return null!==n&&(t.hour=n),t};var w=(e="")=>{if(h(e))return e;if(e=e.trim(),!0===/^'[0-9][0-9]$/.test(e)){let t=Number(e.replace(/'/,""));return t>50?1900+t:2e3+t}let t=parseInt(e,10);return t=t||(new Date).getFullYear(),t};var z=(e="")=>{if(h(e))return e;return e=(e=(e=e.trim()).replace(/^0+/,"")).replace(/([0-9])(st|nd|rd|th)$/i,"$1"),parseInt(e,10)||1},v=[].concat([{reg:/^(-?0{0,2}[0-9]{3,4})-([0-9]{1,2})-([0-9]{1,2})[T| ]([0-9.:]+)(Z|[0-9\-+:]+)?$/i,parse:e=>{let t={year:w(e[1]),month:parseInt(e[2],10),date:z(e[3])};return t.offset=p(e[5]),t=b(e[4],t),t}},{reg:/^([0-9]{4})[-/. ]([0-9]{1,2})[-/. ]([0-9]{1,2})( [0-9]{1,2}(:[0-9]{0,2})?(:[0-9]{0,3})? ?(am|pm)?)?$/i,parse:e=>{let t={year:w(e[1]),month:parseInt(e[2],10),date:z(e[3])};return t.month>12&&(t.date=z(e[2]),t.month=parseInt(e[3],10)),t=b(e[4],t),t}},{reg:/^([0-9]{4})[-/. ]([a-z]+)[-/. ]([0-9]{1,2})( [0-9]{1,2}(:[0-9]{0,2})?(:[0-9]{0,3})? ?(am|pm)?)?$/i,parse:e=>{let t={year:w(e[1]),month:d(e[2]),date:z(e[3]||"")};return t=b(e[4],t),t}}],[{reg:/^([0-9]{1,2})[-/.]([0-9]{1,2})[-/.]?([0-9]{4})?( [0-9]{1,2}:[0-9]{2}:?[0-9]{0,2} ?(am|pm|gmt))?$/i,parse:e=>{let t=parseInt(e[1],10);return{date:z(e[2]),month:t,year:w(e[3])}}},{reg:/^([a-z]+)[-/. ]([0-9]{1,2})[-/. ]?([0-9]{4}|'[0-9]{2})?( [0-9]{1,2}(:[0-9]{0,2})?(:[0-9]{0,3})? ?(am|pm)?)?$/i,parse:e=>{let t={year:w(e[3]),month:d(e[1]),date:z(e[2]||"")};return t=b(e[4],t),t}},{reg:/^([a-z]+) ([0-9]{1,2})( [0-9]{4})?( ([0-9:]+( ?am| ?pm| ?gmt)?))?$/i,parse:e=>{let t={year:w(e[3]),month:d(e[1]),date:z(e[2]||"")};return t=b(e[4],t),t}},{reg:/^([a-z]+) ([0-9]{1,2})( [0-9:]+)?( \+[0-9]{4})?( [0-9]{4})?$/i,parse:e=>{let t={year:w(e[5]),month:d(e[1]),date:z(e[2]||"")};return t=b(e[4],t),t}}],[{reg:/^([0-9]{1,2})[-/]([a-z]+)[-/]?([0-9]{4})?$/i,parse:e=>{let t={year:w(e[3]),month:d(e[2]),date:z(e[1]||"")};return t=b(e[4],t),t}},{reg:/^([0-9]{1,2})( [a-z]+)( [0-9]{4}| '[0-9]{2})? ?([0-9]{1,2}:[0-9]{2}:?[0-9]{0,2} ?(am|pm|gmt))?$/i,parse:e=>{let t={year:w(e[3]),month:d(e[2]),date:z(e[1])};return t.month?(t=b(e[4],t),t):null}},{reg:/^([0-9]{1,2})[ /]([a-z]+)[ /]([0-9]{4})?( [0-9]{1,2}(:[0-9]{0,2})?(:[0-9]{0,3})? ?(am|pm)?)?$/i,parse:e=>{let t={date:z(e[1]),month:d(e[2]),year:w(e[3])};return t=b(e[4],t),t}}],[{reg:/^([0-9]{4})[-/]([0-9]{2})$/,parse:e=>({year:w(e[1]),month:parseInt(e[2],10)})},{reg:/^([a-z]+) ([0-9]{4})$/i,parse:e=>({year:w(e[2]),month:d(e[1])})},{reg:/^(q[0-9])( of)?( [0-9]{4})?/i,parse:e=>{if(e[1],e[3]){return{year:w(e[3])}}return{}}},{reg:/^(spring|summer|winter|fall|autumn)( of)?( [0-9]{4})?/i,parse:e=>{if(e[1],e[3]){return{year:w(e[3])}}return{}}},{reg:/^[0-9,]+ ?b\.?c\.?$/i,parse:e=>{let t=e[0]||"";return t=t.replace(/^([0-9,]+) ?b\.?c\.?$/i,"-$1").trim(),{year:parseInt(t.trim(),10)}}},{reg:/^[0-9,]+ ?(a\.?d\.?|c\.?e\.?)$/i,parse:e=>{let t=e[0]||"";return t=t.replace(/,/g,""),{year:parseInt(t.trim(),10)}}},{reg:/^[0-9]{4}( ?a\.?d\.?)?$/i,parse:e=>({year:w(e[0])})}]);const O=["year","month","date","hour","minute","second","millisecond"];var E=function(e,t,r){if(n=e,"[object Array]"===Object.prototype.toString.call(n)){let t=O.reduce(((t,r,n)=>(t[r]=e[n],t)),{});return t.month&&(t.month=d(t.month)),t}var n,o;if(e&&(o=e,"[object Object]"===Object.prototype.toString.call(o))){if(!0===e.isSpacetime)return e.clone();return Object.assign({},e)}if((e=>"string"==typeof e)(e)){let t=function(e,t){e=(e=(e=(e=(e=(e=e.toLowerCase()).replace(/([0-9])(th|rd|st|nd)\b/,"$1")).replace(/\b(mon|tues?|wed|wednes|thur?s?|fri|sat|satur|sun)(day)?\b/i,"")).replace(/,/g,"")).replace(/ +/g," ").trim()).trim();for(let t=0;t<v.length;t+=1){let r=e.match(v[t].reg);if(null!==r){let e=v[t].parse(r);if(e)return e}}return{}}(e);return null!==t.offset&&void 0!==t.offset&&(t.offset<0?Math.abs(t.offset):t.offset),t}return{}};var T=function(e,t,r){return!(!e.year&&0===!e.year)&&(!(!e.month||e.month<1||e.month>12)&&(!(!e.date||e.date<1||e.date>31)&&(!(e.hour&&e.hour<0&&e.hour>24)&&(!(e.minute&&e.minute<0&&e.minute>60)&&(!(e.second&&e.second<0&&e.second>60)&&(!(e.millisecond&&e.millisecond<0&&e.millisecond>1e3)&&!(e.offset&&e.offset<-14&&e.offset>14)))))))};var M=function(e,t,r){if(t=r.methods.parseTz(t,r),null==e)return{epoch:r.now.epoch(),tz:t};if("number"==typeof(n=e)&&isFinite(n))return r.config.minimumEpoch&&e<r.config.minimumEpoch&&e>0&&(e*=1e3),{epoch:e,tz:t};var n;let o=E(e);if(!1===T(o))throw new Error(`Error: invalid spacetime input: '${e}'`);if(!t){if(o.offset){let e=r.methods.parseTz(o.offset,r);r.zones.hasOwnProperty(e)&&(t=e)}t=t||r.methods.fallbackTz(r)}return{epoch:r.methods.getEpoch(o,t,r),tz:t}};var $=function(e,t){let r=t.zones||{};if(!0===("number"==typeof(n=e)&&isFinite(n))){let t=e;return 0===t?"Etc/GMT":t<0?`Etc/GMT+${Math.abs(t)}`:"Etc/GMT"+-1*t}var n;return e&&r.hasOwnProperty(e)?e:"z"===e||"Z"===e?"Etc/GMT":null};let D=(new Date).getTimezoneOffset()/60;var j=function(e){let t="Etc/GMT"+-1*D;return e.zones.hasOwnProperty(t)?t:e.config.fallbackTz||null};var C=function(e,t){const{HOUR:r}=t.model.ms;let n=t.zones;if(e&&n.hasOwnProperty(e)&&n[e]){let t=n[e],o=t.offset||0;return"s"===t.hem&&t.dst&&(o+=t.change||1),o*r}return 0};const I={};var Y=function(e,t,r){let n=function(e,t){const{YEAR:r,DAY:n}=t.model.ms,o=t.methods.isLeapYear;if(I.hasOwnProperty(e))return I[e];let s=0;if(e>1970)for(let t=1970;t<e;t+=1)o(t)?s+=r+n:s+=r,I[t+1]=s;else{let t=1970;for(;t>e;)t-=1,o(t)?s-=r+n:s-=r,I[t]=s}return s}(e,r);return n-=C(t,r),n};var N=function(e,t,r){const{YEAR:n,DAY:o}=r.model.ms,s=2*o;let a=0;const l=r.methods.isLeapYear;a-=C(t,r);let i=1970;if(e>s)for(;a<=e;){let t=n;l(i)&&(t=n+o);let r=a+t;if(r>e)break;a=r,i+=1}else for(;a>e;){let e=n;l(i)&&(e=n+o),a-=e,i-=1}return{start:a,year:i}};var S=function(e,t,r){const{zones:n,model:o,methods:s}=r,{getYear:a,dstChanges:l}=s,{DAY:i,HOUR:u}=o.ms;let{start:m,year:h}=a(e,t,r),c=n[t]||{},d={year:h,month:1,date:1,hour:0,second:0,millisecond:0,offset:c.offset||0},f=l(t,h,r);if("s"===c.hem){for(let t=0;t<f.length;t+=1)if(e<f[t].epoch){d.offset=f[t].offset,e-=f[t].delta*u;break}d.offset+=1}else for(let t=f.length-1;t>=0;t-=1)if(e>=f[t].epoch){d.offset=f[t].offset,e+=f[t].delta*u;break}let p=e-m,g=Math.floor(p/i),y=function(e,t,r){const{months:n}=r.model,{isLeapYear:o}=r.methods,s=n.map((e=>e.len));let a={month:1,date:1},l=0;for(let r=0;r<n.length-1;r+=1){let n=s[r];if(1===r&&o(t)&&(n=29),l+n>e)break;l+=n,a.month+=1}return a.date+=e-l,a}(g,h,r);Object.assign(d,y);let b=function(e,t){const{SECOND:r,MINUTE:n,HOUR:o}=t.model.ms;let s={hour:0,minute:0,second:0,millisecond:0};return s.hour=Math.floor(e/o),e-=s.hour*o,s.minute=Math.floor(e/n),e-=s.minute*n,s.second=Math.floor(e/r),e-=s.second*r,s.millisecond=e,s}(p-g*i,r);return Object.assign(d,b),d};var A=function(e,t){const r=t.methods.isLeapYear,n=t.model.months;return Object.keys(e).forEach((t=>{var r;void 0!==(r=e[t])&&Number(r)===r&&r%1!=0&&(e[t]=parseInt(e[t],10)),e[t]<0&&"year"!==t&&(e[t]=0)})),e.month=e.month||1,e.date=e.date||1,e.hour=e.hour||0,e.minute=e.minute||0,e.second=e.second||0,e.millisecond=e.millisecond||0,e.month&&e.month>12&&(e.month=12),e.date&&n[e.month-1]&&e.date>n[e.month-1].len&&(2===e.month&&r(e.year)?e.date=29:e.date=n[e.month-1].len),e.hour&&e.hour>24&&(e.month=24),e.minute&&e.minute>59&&(e.month=59),e.second&&e.second>59&&(e.second=59),e.millisecond&&e.millisecond>999&&(e.millisecond=999),e};var k=function(e,t,r,n){const{DAY:o,HOUR:s,MINUTE:a,SECOND:l}=n.model.ms;let i=function(e,t,r){const{isLeapYear:n}=r.methods,{months:o}=r.model;let s=0;for(let r=e.month;r<t.month;r+=1)s+=o[r-1].len,2===r&&n(e.year)&&(s+=1);return s+=t.date-e.date,s}(t,r,n);return e+=i*o,t.month=r.month,t.date=r.date,i=r.hour-t.hour,e+=i*s,t.hour+=i,i=r.minute-t.minute,e+=i*a,t.minute+=i,i=r.second-t.second,e+=i*l,t.second+=i,i=r.millisecond-t.millisecond,e+=i,t.millisecond+=i,function(e,t){const r=["year","month","date","hour","minute","second","millisecond"];for(let n=0;n<r.length;n+=1){let o=r[n];if(e[o]!==t[o])return console.error("\n----\nMis-matched unit in walk:",o),console.error(e,"\n",t),!1}}(t,r),e};const G={month:1,date:1,hour:0,minute:0,second:0,millisecond:0};var L=function(e,t,r){const{yearStart:n,dstChanges:o}=r.methods;let s=n((e=A(e,r)).year,t,r),a=Object.assign({},G,{year:e.year}),l=o(t,e.year,r).reverse().find((t=>function(e,t){const r=["year","month","date","hour","minute","second","millisecond"];for(let n=0;n<r.length;n+=1){let o=r[n];if(e[o]>t[o])return!0;if(e[o]<t[o])return!1}return!0}(e,t.cal)));return l&&(s=l.epoch,a=Object.assign({},G,l.cal,{year:e.year})),s=k(s,a,e,r),s};var U={isLeapYear:e=>e%4==0&&(e%100!=0||e%400==0),getDay:e=>m(e.year,e.month,e.date),parse:M,parseTz:$,fallbackTz:j,yearStart:Y,getEpoch:L,dstChanges:()=>[],getYear:N,getCal:S};let R={year:e=>e.year,month:e=>e.month-1,date:e=>e.date,hour:e=>e.hour,minute:e=>e.minute,second:e=>e.second,millisecond:e=>e.millisecond,day:e=>getDay(e.year,e.month,e.date),ampm:e=>e.hour<12?"am":"pm",decade:e=>10*Math.floor(e.year/10),century:e=>100*Math.floor(e.year/100),millenium:e=>{let t=Math.floor(e.year/1e3);return t>=0?t+1:t},era:e=>e.year<0?"BC":"AD",quarter:e=>{let t=e.month;return t<3?1:t<6?2:t<9?3:4},season:e=>{},dayTime:e=>{},hour12:e=>{let t=e.hour;return t>12?t-12:0===t?12:t},hourFloat:e=>{let t=e.minute;return t/=60,e.hour+t},dayName:(e,t,r)=>{let n=R.day(e);return r.i18n.days.longForm[n]},monthName:(e,t,r)=>{let n=R.month(e);return r.i18n.months.longForm[n]}};var F=R;let P={},_={};Object.keys(F).forEach((e=>{_[e]=function(t,r){let{epoch:n,tz:o,world:s}=this,a=s.methods.getCal(n,o,s);if(void 0!==t){let n=P[e](t,a,o,r),l=s.methods.getEpoch(n,o,s);return this._from(l,o)}return F[e](a,o,s)}})),_.time=function(e){if(void 0!==e){let{epoch:t,tz:r,world:n}=this,o=n.methods.getCal(t,r),s=P.time(e,o,r),a=n.methods.getEpoch(s,r,this.world);return this._from(a,r)}return this.format("time")},_.clone=function(){return this._from(this.epoch,this.tz)},_.isValid=function(){let{epoch:e,tz:t,world:r}=this;return r.methods.getCal(e,t),!0},_.hasDst=function(){let{tz:e,world:t}=this;return t.zones[e].dst},_.isAsleep=function(){return!1},_.offset=function(){let{epoch:e,tz:t,world:r}=this;return r.methods.getCal(e,t).offset},_.inDst=function(){let{epoch:e,tz:t,world:r}=this;const{getCal:n,dstChanges:o}=r.methods;if(!this.hasDst())return!1;return o(t,n(e,t).year,r),!0},_.json=function(){let{epoch:e,tz:t,world:r}=this;const{getCal:n,dstChanges:o}=r.methods;let s=n(e,t);s.epoch=e,s.tz=t;let a=r.zones[t]||{};return s.hem=a.hem,s.abbrevs=a.shrt,s.dst=o(t,s.year),s},_.fmt=_.format,_.text=_.format,_.inDST=_.inDst,_.hasDST=_.hasDst;var H=_;return o.plugin({model:l,config:{useTitleCase:!0,weekStart:1,fallbackTz:"Etc/Utc",fallbackHemisphere:"n",preferDMY:!1},zones:u,methods:U,api:H}),o}));
